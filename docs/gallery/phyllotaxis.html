<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiI+CiAgPHJlY3QgZmlsbD0iIzBhMGEwYSIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIi8+CiAgPHBhdGggZD0iTTggOCBMMjQgOCBMMjQgMjQgTDggMjQgWiBNMTIgMTIgTDIwIDEyIEwyMCAyMCBMMTIgMjAgWiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZTBlMGUwIiBzdHJva2Utd2lkdGg9IjEuNSIvPgo8L3N2Zz4K"/>
<title>Phyllotaxis</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;background:#05070b;overflow:hidden}
canvas{display:block;width:100%;height:100%}
#info{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);color:rgba(255,255,255,0.9);background:rgba(0,0,0,0.6);padding:6px 12px;border-radius:6px;text-shadow:0 1px 3px rgba(0,0,0,0.9);font:13px/1.4 ui-monospace,monospace;pointer-events:none;text-align:center}
.back-btn{position:fixed;top:16px;right:16px;background:rgba(20,20,20,0.8);border:1px solid #444;color:#e0e0e0;padding:8px 14px;border-radius:6px;font:12px ui-monospace,monospace;cursor:pointer;text-decoration:none;backdrop-filter:blur(8px);z-index:1000;transition:border-color 0.2s}
.back-btn:hover{border-color:#888}
</style>
</head>
<body>
<a href="./" class="back-btn">← Gallery</a>
<canvas id="c"></canvas>
<div id="info">Phyllotaxis · golden angle 137.5° · click to pulse</div>
<script>
const c = document.getElementById('c');
const ctx = c.getContext('2d');

// Golden angle: 2π × (2 − φ) where φ = (1+√5)/2
const PHI = (1 + Math.sqrt(5)) / 2;
const GOLDEN_ANGLE = Math.PI * 2 * (2 - PHI); // ≈ 137.508°

const N = 1400;
let W, H, ox, oy, maxR;
let t = 0;
let pulse = 0; // 0..1 pulse wave on click

function resize() {
  W = c.width = innerWidth;
  H = c.height = innerHeight;
  ox = W / 2;
  oy = H / 2;
  maxR = Math.min(W, H) * 0.455;
}

addEventListener('resize', resize);
resize();

c.addEventListener('click', () => {
  pulse = 1;
});

function loop() {
  t += 0.006;
  pulse = Math.max(0, pulse - 0.03);

  ctx.fillStyle = 'rgba(5,7,11,0.18)';
  ctx.fillRect(0, 0, W, H);

  for (let i = 0; i < N; i++) {
    const frac = i / N;

    // Base spiral position — slow rotation over time
    const theta = i * GOLDEN_ANGLE + t * 0.08;
    const r = maxR * Math.sqrt(frac);

    // Pulse: radial breathe
    const pulseFactor = 1 + pulse * 0.18 * Math.sin(frac * Math.PI * 4);
    const pr = r * pulseFactor;

    const x = ox + pr * Math.cos(theta);
    const y = oy + pr * Math.sin(theta);

    // Color: hue travels along the spiral; time shifts it
    const hue = (200 + frac * 200 + t * 18 + pulse * 60) % 360;
    const lightness = 45 + frac * 25;
    const alpha = 0.55 + frac * 0.45;
    const radius = 1.5 + frac * 2.2;

    ctx.beginPath();
    ctx.arc(x, y, radius, 0, Math.PI * 2);
    ctx.fillStyle = `hsla(${hue},85%,${lightness}%,${alpha})`;
    ctx.fill();
  }

  requestAnimationFrame(loop);
}

loop();
</script>
<script>(function(){var inFrame=false;try{inFrame=window.self!==window.top}catch(e){inFrame=true}if(inFrame)document.querySelectorAll("#info,.info,#ctrl,#buttons,#depth,.controls,#mode,button,.back-btn").forEach(function(e){e.style.display="none"})})()</script>
</body>
</html>
